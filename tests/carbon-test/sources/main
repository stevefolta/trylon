trylon-package Main

class Window
	superclass Carbon WindowManager Window

	fn create
		super create: (Rectangle new: (100, 100, 400, 400)) --
			attributes: ('standard-document-attributes', 'standard-handler', 	--
			             'in-window-menu')

	fn handle-event
		print-line: "Got window event."
		save-port := Carbon QuickDraw port
		Carbon QuickDraw window-port: this
		Carbon QuickDraw erase-rect: this port-bounds
		context := Carbon QuickDraw begin-cg-context: Carbon QuickDraw port
		draw: context
		Carbon QuickDraw end-cg-context: Carbon QuickDraw port context: context
		Carbon QuickDraw port: save-port

	fn draw: context
		style := Carbon ATSUI Style new
		style size: 24
		layout := Carbon ATSUI TextLayout new
		layout text: "Hello world!"
		layout style: style
		layout cg-context: context
		layout draw-x: 20 y: 40

fn main: args
	window := Window new
	window show
	Carbon EventManager run-application-event-loop

