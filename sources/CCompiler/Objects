trylon Objects

extend Compiler CompiledProto
	field .c-name

	c-name
		if .c-name == nil
			.c-name = mangle-name: name
			if parent && !(parent is-main)
				.c-name = parent c-name + "__" + .c-name
		return .c-name


	emit-field-indices: stream
		index = 0
		if superclass
			index = superclass emit-field-indices: stream
		
		for field in fields
			stream write: "#define "
			stream write: (mangle-name: field name)
			stream write: "__fld_\t("
			stream write: index string
			index += 1
			stream write-line: ")"
		
		stream write-line

		return index


	total-num-fields
		total = fields count
		if superclass
			total += superclass total-num-fields
		return total


# Copyright 2007 Steve Folta
# See the License file.

