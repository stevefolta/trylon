<!doctype html PUBLIC "-//W3C//DTD HTML 4.0//EN">
<html>

<head>

<title> 
Statements
</title>

<style type="text/css">
body {
	margin-top: 0.5in;
	margin-bottom: 0.5in;
	margin-left: auto;
	margin-right: auto;
	width: 7in;
	font-family: Bitstream Charter, Lucida Grande, Georgia, Times, serif;
}

h2 {
	margin-top: 1.25em;
	margin-bottom: 0.5em;
	font-family: Arial, Helvetica, sans-serif;
	font-weight: bolder;
	font-size: 1.4em;
}

p {
}

div.entry {
	border-bottom: solid 1px #cccccc;
	margin-bottom: 1.75em;
	padding-bottom: 1em;
}

div.entry-title {
	margin-top: 1.25em;
	font-family: Arial, Helvetical, sans-serif;
	font-weight: bolder;
	font-size: 1.025em;
}

div.entry-date {
	margin-bottom: 1.05em;
	font-style: italic;
	font-size: x-small;
	color: gray;
}

div.titleless-entry-date {
	margin-bottom: 0.5em;
	font-style: italic;
	font-size: x-small;
	color: gray;
}

div.code {
	margin-bottom: 1em;
	font-family: Courier, monospace;
	font-size: smaller;
	margin-left: 2em;
	margin-right: 2em;
	white-space: pre;
}

</style>

</head>


<body>

<h2>
Statements
</h2>

<div class="entry">
<div class="entry-title"> Control </div>
<p>
There are the usual flow-of-control statements:
</p>

<div class="code">if name == "anyone"
  print-line: "Anyone"

if x == 0
  return 0
else
  return x * (factorial: x - 1)

return   # No value given, so this returns "nil".

loop
  token = next-token
  if token type == 'eof'
    break
  consume-token

  if token type == 'comment'
    continue

while which-item < num-items
  print-line: (items at: which-item)
  which-item += 1

for item in items
  if item name is-empty
    continue
  print-line: item name

try
  event-loop
else
  # "exception" is automatically defined as the caught object.
  print-line: exception message

throw MessageException new: "Couldn't connect."

switch justification
  'left'
    # ...
  'right'
    # ...
  'center', 'centered'
    # ...
  'justified'
    # ...
  else
    throw   --
      MessageException  --
        new: "Bad justification: " + justification string</div>

</div>

<div class="entry">
<div class="entry-title"> Expression Statements </div>
<p>
An expression on a line by itself also constitutes a statement:
</p>

<div class="code">print-line: "Hello world!"</div>

</div>

<div class="entry">
<div class="entry-title"> Assignment </div>
<p>
Assignment in Trylon is designed to be easy to read (and type), but the rules behind it can be a little complex.
</p>

<div class="code">proto MyObject
  fields total

  grand-total = 0   # A shared variable, with its initial value.

  reset
    total = 0   # Sets the object's "total" field.

  frobnicate: value
    massaged-value = value * 7 + 3   # Creates a new local variable.
    total = total + massaged-value   # Sets the object's "total" field.
    grand-total = grand-total + massaged-value   # Sets the shared variable.</div>

<p>
The basic idea is that an assignment will assign to a variable in the current scope, and if no such variable exists, a new local variable will be created.  The scope of the new local is the block in which it is assigned.
</p>

<p>
Assignment can also be a shorthand for a function call:
</p>

<div class="code">(array at: 7) = "hello"   # is the same as:
array at: 7 put: "hello"</div>

<p>
If the function being set is a unary function, rather than a keyword function, then the setter function's name is the unary function's name with a colon appended:
</p>

<div class="code">proto MyProto
  fields real-name

  name
    return real-name

  name: new-name
    real-name = new-name + " Jr."

obj = MyProto new
obj name = "Joey Jo Jo Shabbadoo"
print-line: obj name   # Prints "Joey Jo Jo Shabbadoo Jr."</div>

<p>
(Indeed, the compiler treats *all* assignments this way, even those to local variables.  So "foo = bar" can always be written as "foo: bar".)
</p>

<p>
Assignments are expressions, so you can do things like "x = y = 0".
</p>

</div>

<div class="entry">
<div class="entry-title"> The "for" Statement </div>
<p>
A "for" statement can iterate over any collection that responds to the "iterate" message with an iterator object that responds to the "is-done", "current-item", and "go-forward" messages.  So this:
</p>

<div class="code">for item in collection
  print: item string</div>

<p>
is roughly equivalent to this:
</p>

<div class="code">iterator = collection iterator
while !iterator is-done
  item = iterator current-item

  print: item string

  iterator go-forward</div>

<p>
(I say "roughly" because the "continue" statement would work correctly in a real "for" loop, and because the "iterator" variable isn't visible.)
</p>

</div>

<div class="entry">
<div class="entry-title"> Conditional Compilation ("iff" Statements) </div>
<p>
The "iff" statement is used for conditional compilation:
</p>

<div class="code">iff debug
  print-line: "Reached a certain point."</div>

<p>
In this case, "debug" is not an expression, but the name of a symbol.  If that symbol is defined in the build-settings, the block will be compiled.  If not (or if it's set to "false"), the block will be completely ignored by the compiler.
</p>

<p>
You can't use an "else" block with an "iff" statement (not yet, anyway), but you can put a "!" before the symbol to reverse the sense of the test.
</p>

<div class="code">version = "1.0 "
iff development
  version += "development"
iff !development
  version += "release"</div>

<p>
A few symbols are defined automatically in the build-settings.  Most notably, the "sysname" (what you'd see if you typed "uname" at the shell) is defined.
</p>

<div class="code">display = nil
iff Linux
  display = XlibDisplay new
iff Darwin
  # Mac OSX calls itself Darwin, for the purposes of "uname".
  display = CarbonDisplay new</div>

<p>
Also defined are "trylon-2" (to distinguish from Trylon 1), "targeting-c" or "targeting-jolt", depending on which backend you're using, and "in-jolt" if the compiler itself is actually running within Jolt.
</p>

</div>



</body>
</html>
