trylon-class Tuple

field num-items

class-fn new: num-items
	tuple [Tuple] := --
		Implementation allocate-object: Tuple with-extra-slots: num-items
	tuple num-items = num-items
	return tuple

fn at: index
	if index < 0 || index >= num-items
		throw MessageException new: "Bad tuple index."
	return this object-ptr object-at: index + 2

fn at: index set-to: value
	if index < 0 || index >= num-items
		throw MessageException new: "Bad tuple index."
	this object-ptr object-at: index + 2 set-to: value

fn iterator
	return Iterator new: this

class Iterator
	superclass Standard Iterator
	field tuple
	field index
	fn create: tuple
		this tuple = tuple
		index = 0
	fn is-done -> Bool
		return index < tuple num-items
	fn current-item -> Object
		return tuple at: index
	fn go-forward
		index += 1
